[?25l╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🚶 [0m [1;32mStarting training...[0m                                                                                                                                                                        │
[2K[1A[2K[1A[2KStarting epoch: [1;36m1[0m──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🚶 [0m [1;32mStarting training...[0m                                                                                                                                                                        │
[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🏃 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m  0%[0m [36m-:--:--[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🏃 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m  0%[0m [36m-:--:--[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🏃 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m  0%[0m [36m-:--:--[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🏃 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m  0%[0m [36m-:--:--[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2KCurrent local training loss: [1;36m3.12349e-01[0m───────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🏃 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m  0%[0m [36m-:--:--[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🏃 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━[0m[38;5;237m╺[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m  3%[0m [36m-:--:--[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🚶 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━[0m[38;5;237m╺[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m  3%[0m [36m-:--:--[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🚶 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━[0m[38;5;237m╺[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m  3%[0m [36m-:--:--[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2KCurrent local training loss: [1;36m2.78412e-01[0m───────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🚶 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━[0m[38;5;237m╺[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m  3%[0m [36m-:--:--[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🚶 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━[0m[38;2;249;38;114m╸[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m  6%[0m [36m0:00:29[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🚶 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━[0m[38;2;249;38;114m╸[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m  6%[0m [36m0:00:29[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🏃 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━[0m[38;2;249;38;114m╸[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m  6%[0m [36m0:00:29[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🏃 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━[0m[38;2;249;38;114m╸[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m  6%[0m [36m0:00:29[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2KCurrent local training loss: [1;36m2.66866e-01[0m───────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🏃 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━[0m[38;2;249;38;114m╸[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m  6%[0m [36m0:00:29[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🏃 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━━[0m[38;2;249;38;114m╸[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m  9%[0m [36m0:00:28[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🏃 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━━[0m[38;2;249;38;114m╸[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m  9%[0m [36m0:00:28[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🏃 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━━[0m[38;2;249;38;114m╸[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m  9%[0m [36m0:00:28[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🚶 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━━[0m[38;2;249;38;114m╸[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m  9%[0m [36m0:00:28[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2KCurrent local training loss: [1;36m2.60197e-01[0m───────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🏃 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━━[0m[38;2;249;38;114m╸[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m  9%[0m [36m0:00:28[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🚶 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━━━━[0m[38;5;237m╺[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m 12%[0m [36m0:00:27[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🚶 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━━━━[0m[38;5;237m╺[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m 12%[0m [36m0:00:27[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🚶 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━━━━[0m[38;5;237m╺[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m 12%[0m [36m0:00:27[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🚶 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━━━━[0m[38;5;237m╺[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m 12%[0m [36m0:00:27[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2KCurrent local training loss: [1;36m2.55390e-01[0m───────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🚶 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━━━━[0m[38;5;237m╺[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m 12%[0m [36m0:00:27[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🏃 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━━━━━[0m[38;5;237m╺[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m 16%[0m [36m0:00:26[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🏃 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━━━━━[0m[38;5;237m╺[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m 16%[0m [36m0:00:26[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🏃 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━━━━━[0m[38;5;237m╺[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m 16%[0m [36m0:00:26[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🏃 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━━━━━[0m[38;5;237m╺[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m 16%[0m [36m0:00:26[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2KCurrent local training loss: [1;36m2.49841e-01[0m───────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🏃 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━━━━━[0m[38;5;237m╺[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m 16%[0m [36m0:00:26[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🏃 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━━━━━━[0m[38;2;249;38;114m╸[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m 19%[0m [36m0:00:25[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🚶 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━━━━━━[0m[38;2;249;38;114m╸[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m 19%[0m [36m0:00:25[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🚶 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━━━━━━[0m[38;2;249;38;114m╸[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m 19%[0m [36m0:00:25[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2KCurrent local training loss: [1;36m2.45599e-01[0m───────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🚶 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━━━━━━[0m[38;2;249;38;114m╸[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m 19%[0m [36m0:00:25[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🚶 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━━━━━━━[0m[38;2;249;38;114m╸[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m 22%[0m [36m0:00:24[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🚶 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━━━━━━━[0m[38;2;249;38;114m╸[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m 22%[0m [36m0:00:24[0m                                                                                                                                  │
[2K[1A[2K[1A[2K[1A[2K╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ [32m🚶 [0m [1;32mTraining epoch 1 ...[0m                                                                                                                                                                        │
│ Training [38;2;249;38;114m━━━━━━━━[0m[38;2;249;38;114m╸[0m[38;5;237m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m [35m 22%[0m [36m0:00:24[0m                                                                                                                                  │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[?25h
Traceback (most recent call last):
  File "/csghome/hpdc04/Transformer_Code/CUPY/models/GoePT/model.py", line 460, in <module>
    main()
  File "/csghome/hpdc04/Transformer_Code/CUPY/models/GoePT/model.py", line 370, in main
    model.backward(grad)
  File "/csghome/hpdc04/Transformer_Code/CUPY/models/GoePT/model.py", line 142, in backward
    x = block.backward(x)
  File "/csghome/hpdc04/Transformer_Code/CUPY/models/GoePT/layers.py", line 767, in backward
    grad = self.mlp.backward(grad_output)
  File "/csghome/hpdc04/Transformer_Code/CUPY/models/GoePT/layers.py", line 398, in backward
    x = self.c_proj.backward(x)
  File "/csghome/hpdc04/Transformer_Code/CUPY/models/GoePT/layers.py", line 139, in backward
    grad_input = self._multi_dim_matmul(grad_output,
  File "/csghome/hpdc04/Transformer_Code/CUPY/models/GoePT/layers.py", line 93, in _multi_dim_matmul
    (int((cp.prod(cp.array(mat_a.shape[:-1])))), mat_a.shape[-1])
KeyboardInterrupt
